=head1 名前

Net::Cmd - ネットワーク・コマンド　クラス　（FTP、SMTPなどによって使われます）

=head1 概要

    use Net::Cmd;

    @ISA = qw(Net::Cmd);

=head1 説明

C<Net::Cmd>はIO::Handleのサブクラスが継承することができるメソッドを
集めたものです。これらのメソッドはFTPやSMTPといった、コマンドをベースとした
プロトコルに必要とされる機能を実装しています。

=head1 ユーザ・メソッド

これらのメソッドがC<Net::Cmd>オブジェクトへのユーザ・インターフェースを提供します。

=over 4

=item debug ( VALUE )

このオブジェクトのデバッグ情報のレベルを設定します。C<VALUE>が指定されなければ、
現在のステータスを返します。そうでなければ、ステータスはC<VALUE>に変更され、
前の値を返します。

パッケージが違えば、異なるデバッグ・レベルを実装するかもしれません。
全てのコマンドと応答での0でない値は標準エラー出力(STDERR)に出力されます。

C<VALUE>がC<undef>であれば、デバッグレベルは、このクラスのためのデフォルトの
デバッグレベルに設定されます。

このメソッドは与えられたクラスのデフォルトのデバッグレベルを設定/取得するため、
staticメソッドとしても呼び出すことができます。

=item message ()

最後のコマンドから返されたテキストメッセージを返します。 

=item code ()

最後のコマンドの3桁の数字コードを返します。
コマンドが保留中であれば0が返されます

=item ok ()

最後のコード値が0より大きく400より小さければ0でない値を返します。
これは大抵のコマンド・サーバではtrueになります。これを持たない
サーバでは、このメソッドを上書きすることもできます。 

=item status ()

現在のステータス・コードでの最も特徴的な数字を返します。もしコマンドが
保留中であればC<CMD_PENDING>が返されます。

=item datasend ( DATA )

リモート・サーバにデータを送信します。このときLFはCRLFに変換されます。
'.'（ピリオド）で始まるすべての行には、前にもう１つ'.'（ピリオド） が
付けられます。C<DATA>には配列もしくは配列のリファレンスを指定します。 

=item dataend ()

リモート・サーバへのデータの送信を終了させます。
既に送られたデータをCRLF付きで終了させ、伝送を完了させるための
'.CRLF'を送信することにより明確に行われます。
一度データが送られるとC<dataend>呼び出しは、C<response>を呼び出し、
C<response>がCMD_OKであればtrueを返します。

=back

=head1 クラス・メソッド

これらのメソッドはユーザーによって呼び出されるのではなく、
C<Net::Cmd>のサブクラスによって使われる、あるいはオーバーライドされる
ことが想定されています。

=over 4

=item debug_print ( DIR, TEXT )

デバッグ情報を出力します。C<DIR>は方向を示し、trueはサーバーに送信される
データを示します。標準エラー出力に出力される前にC<debug_text>を呼びます。 

=item debug_text ( TEXT )

デバッグ情報を出力するために呼ばれます。TEXTは送信される文字列です。
このメソッドは出力される文字列を返します。

これは主に、パスワードが送信されるけれどデバッグ情報では表示したくない
というFTPのようなモジュールで使われることに意味があります。

=item command ( CMD [, ARGS, ... ])

コマンド・サーバにコマンドを送信します。すべての引数はまず空白とCRLFを付けて、
１つにまとめられます。そしてその文字列がコマンド・サーバーに送信されます。

失敗した場合にはundefが返ります。

=item unsupported ()

ステータスコードを580に設定し、レスポンス・テキストを'Unsupported command'にします。
0を返します。

=item response ()

サーバからのレスポンスを取得します。成功すればステータスのも最も特徴的な数字が返ります。
タイムアウトなどで失敗すれば、I<undef>が返されます。

=item parse_response ( TEXT )

このメソッドは１つの引数をもつメソッドとしてC<response>により呼び出されます。
3桁のステータス・コードと、これが複数行の応答の一部であり、この行はリストでは
ないときにはtrueになるフラグという2つの値をもつ配列を返します。 

=item getline ()

CRLFで区切られた1行をリモートサーバから取り出します。 失敗するとI<undef>を返します。

B<注意>： なんらかの理由でこのメソッドを使わないのであれば、あなたのメソッドのなかに、
いくつかC<debug_print>の呼び出しを入れることを忘れないで下さい。

=item ungetline ( TEXT )

サーバからのテキスト行の取り出しを元に戻します。

=item read_until_dot ()

リモートサーバからデータを、１つの'.'（ピリオド）だけの行まで読み込みます。
'..'で始まるすべての行は、最初の'.'が削除されます。

行の内容が入ったリストへのリファレンスが返されます。失敗するとI<undef>です。

=item tied_fh ()

Net::Cmdオブジェクトに結び付けられたファイルハンドルを返します。
コマンドを発行した後、read() や <>を使って、このファイルハンドルから
読み込むことが出来ます。最後のドットにぶつかると、ファイルハンドルは
Eofを返します。
同様に、書き込まれるデータを期待しているコマンドを発行した後、
そのサーバーにデータを送信するため、そのファイルハンドルに
書き込むことができます。

この例については、Net::POP3 と Net::SMTP をご覧ください。

=back

=head1 EXPORTS

C<Net::Cmd>は6つのサブルーチンをエキスポートします。そのうちの5つ
C<CMD_INFO>、 C<CMD_OK>、C<CMD_MORE>、C<CMD_REJECT>、C<CMD_ERROR>は
C<response> と C<status>の可能な結果に対応します。6番目はC<CMD_PENDING>です。

=head1 作者

Graham Barr <gbarr@pobox.com>

=head1 著作権(COPYRIGHT)

Copyright (c) 1995-1997 Graham Barr. All rights reserved.
This program is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

=for html <hr>

I<$Id$>

